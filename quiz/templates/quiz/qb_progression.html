{% extends 'quiz/base.html' %}
{% load static %}
{% load staticfiles %}

{% block content %}

{% endblock %}
{% block header %}
QB Progression
{% endblock %}

{% block edit_test_button %}
<a class="btn btn-success" href="/tests/{{test.id}}/edit">Edit Test</a>
{% endblock %}


{% block quiz_type %}
<script language="javascript" type="text/javascript" src="{% static 'quiz/QBProgression.js' %}"></script>
<script type="text/javascript">
$('#play-button').click(function(){
  pressPlayButton();
})

$('#pause-button').click(function(){
  pressPlayButton();
})

$('#check-button').click(function(){
  if (test.getCurrentPlay()){
    if(test.showDemo){
      demoComplete = true;
      return false;
    }
    var isCorrect = test.getCurrentPlay().checkProgression();
    test.updateScoreboard();
    if(!isCorrect){
      test.getCurrentPlay().eligibleReceivers.forEach(function(player){
        player.rank = player.progressionRank
        player.showRoute = true;
      })
      test.feedbackScreenStartTime = millis();
    }
  }
})

$('#clear-button').click(function(){
  if (test.getCurrentPlay()){
    test.getCurrentPlay().clearProgression();
    test.scoreboard.feedbackMessage = "";
  }
})

$('#restart-button').click(function(){
  pressStopButton();
  if(test && test.feedbackScreenStartTime === 0){
    test.restartQuiz(defensePlay);
  }
})

$('#next-play-button').click(function(){
  if (test.getCurrentPlay()){
    if(test.showDemo){
      exitDemoScreen();
      return;
    }
    if(test.feedbackScreenStartTime > 0){
      return;
    }
    pressStopButton();
    test.skipQuestion();
    if (test.getCurrentPlay()){
      test.getCurrentPlay().inProgress = false;
    }
  }
})

$('#question-button').click(function(){
  if(test.getCurrentPlay()){
    if(test.showDemo){
      exitDemoScreen();
    }else{
      setupDemoScreen();
    }
  }
})


</script>
{% endblock %}
